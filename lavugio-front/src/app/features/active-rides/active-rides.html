<div class="min-h-screen bg-gray-50">
  <app-navbar></app-navbar>
  
  <div class="max-w-4xl mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-8">My Active Rides</h1>

    <!-- Loading state -->
    @if (isLoading) {
      <div class="text-center py-12">
        <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#BC6C25]"></div>
        <p class="mt-4 text-gray-600">Loading your active rides...</p>
      </div>
    }

    <!-- Error state -->
    @if (error && !isLoading) {
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
        {{ error }}
      </div>
    }

    <!-- Empty state -->
    @if (activeRides.length === 0 && !isLoading && !error) {
      <div class="text-center py-12">
        <p class="text-gray-500 text-lg">You don't have any active rides right now.</p>
        <button 
          (click)="router.navigate(['/find-trip'])"
          class="mt-6 bg-[#BC6C25] text-white px-6 py-2 rounded-lg hover:bg-[#A0581E] transition">
          Find a Trip
        </button>
      </div>
    }

    <!-- Rides list -->
    @if (activeRides.length > 0 && !isLoading) {
      <div class="space-y-4">
        @for (ride of activeRides; track ride.id) {
          <div class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition">
            <div class="flex justify-between items-start mb-4">
              <div>
                <h2 class="text-2xl font-bold text-gray-800">Ride #{{ ride.id }}</h2>
                <p class="text-gray-600">
                  <span [class]="'px-3 py-1 rounded-full text-sm font-semibold ' + getRideStatusClass(ride.rideStatus)">
                    {{ ride.rideStatus }}
                  </span>
                </p>
              </div>
              <button 
                (click)="viewRideDetails(ride.id)"
                class="bg-[#BC6C25] text-white px-6 py-2 rounded-lg hover:bg-[#A0581E] transition">
                View Details
              </button>
            </div>

            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <p class="text-gray-600 text-sm">Pickup Location</p>
                <p class="font-semibold text-gray-800">{{ ride.startLocation || 'N/A' }}</p>
              </div>
              <div>
                <p class="text-gray-600 text-sm">Destination</p>
                <p class="font-semibold text-gray-800">{{ ride.endLocation || 'N/A' }}</p>
              </div>
              <div>
                <p class="text-gray-600 text-sm">Start Time</p>
                <p class="font-semibold text-gray-800">{{ formatDate(ride.startDateTime) }}</p>
              </div>
              <div>
                <p class="text-gray-600 text-sm">Price</p>
                <p class="font-semibold text-gray-800">{{ ride.price }} РСД</p>
              </div>
            </div>

            @if (ride.rideStatus === 'ACTIVE') {
              <div class="bg-green-50 border border-green-200 rounded p-3 text-green-700 text-sm">
                ✓ This ride is currently active
              </div>
            }
          </div>
        }
      </div>
    }
  </div>
</div>
